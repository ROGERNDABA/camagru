<?php
/*
 *
 *    File created by Roger Ndaba
 *    Project: camagru
 *    File: public.phtml
 *
 */
    include('connect.php');
    session_start();
    $conn = conOpen();
    $useranme = $_SESSION['user'];
    
?>

<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="public.css">
    <link rel="stylesheet" href="buttons.css">
    <link rel="stylesheet" href="paginate.css">
    <link rel="icon" href="./images/camagru.png">
    <title>Camagru Public</title>


</head>
<body>
    <div class="icon_wrapper">
        <div class="icon">
        <a href="index.html"><img src="./images/camagru.png" class="ims"></a>    
            <div class="profile">
                <div class="pro_ico"><img src="./images/profile.png" style="width:100%;height:100%"></div>
                <p class="username"><?php echo $_SESSION['user'] ?></p>
            </div>
        </div>
    </div>
    <?php if (isset($_GET['bye'])){ echo "<div id='bye'>".$_GET['bye']."</div>"; unset($_GET['bye']); session_destroy();}?>
<div id="container">
    <nav>
        <ul>
            <li><a href="#">home</a>
                <ul>
                    <li><a href="login.phtml">LOGIN</a></li>
                    <li><a href="new_account.phtml">SIGN UP</a></li>
                </ul>
            </li>
            
            <?php
                if ($_SESSION['user'])
                    echo 
                        '<li><a href="#">account</a>
                        <ul>
                            <li><a href="#">profile</a></li>
                            <li><a href="#">setings</a></li>
                            <li><a href="forgot_password.phtml">password reset</a></li>
                        </ul>        
                    </li>'.
                    '<li><a href="home.phtml">my studio</a>';
            ?>
            </li>
            <li><a href="#">Inspiration</a></li>
            <li><a href="#">Contact</a></li>
            <?php if(isset($_SESSION) && $_SESSION['user']) echo "<li id='logout' onclick='remove()'><a style='background-color:white;cursor:pointer'>LOGOUT</a></li>" ?>
        </ul>
    </nav>
</div>
    <article>
        <div class="photo_type">
            asdfadsda
        </div>
        <div id="grid">
            <?php
                $i = 1;
                
                $stmt = $conn->prepare("SELECT `pic`, `likes`, `username`, `ID` FROM `images` ORDER BY `create_date` DESC");
                $stmt->execute();
                while (($row = $stmt->fetch(PDO::FETCH_ASSOC)) && $i < 6) {
                    echo '<div class="imge"><img id="'.$row['ID'].'" src="data:image/png;base64,'.$row['pic'].'" style="height:90%" alt=""></div>';
                    $i++;
                }
            ?>
            

        </div>
        <hr>
        <div class='buttons_container'>
            <div class="buttons">
                <button class="next_prev">PREV</button>
                <button class="next_prev">NEXT</button>
            </div>
        </div>
        <div id="preview">
            <div class="one">
                <img id="preview_pic" style="height:100%" alt="">
            </div>
            <div class="two">
                <div id="comments"><br>
                    <ul><li><span style="color:red">sdfsdfsdf - </span>asdfsfsdf sdfljsdlfsdfjs sdfljsdfljsdf sdflsdjfldsfjds sdfldjsfldsjfljdsf sdfldsjflsdjflsdf sdfljsdfljsdlfjsdlf sdlfjsdljflsdjf sdlfjsdljflsdjfdjs fsdlfjlsdfjsdlf</li></ul>
                    <ul><li><span style="color:red">sdfsdfsdf - </span>asdfsfsdf sdfljsdlfsdfjs sdfljsdfljsdf sdflsdjfldsfjds sdfldjsfldsjfljdsf sdfldsjflsdjflsdf sdfljsdfljsdlfjsdlf sdlfjsdljflsdjf sdlfjsdljflsdjfdjs fsdlfjlsdfjsdlf</li></ul>
                    <ul><li><span style="color:red">sdfsdfsdf - </span>asdfsfsdf sdfljsdlfsdfjs sdfljsdfljsdf sdflsdjfldsfjds sdfldjsfldsjfljdsf sdfldsjflsdjflsdf sdfljsdfljsdlfjsdlf sdlfjsdljflsdjf sdlfjsdljflsdjfdjs fsdlfjlsdfjsdlf</li></ul>
                    <ul><li><span style="color:red">sdfsdfsdf - </span>asdfsfsdf sdfljsdlfsdfjs sdfljsdfljsdf sdflsdjfldsfjds sdfldjsfldsjfljdsf sdfldsjflsdjflsdf sdfljsdfljsdlfjsdlf sdlfjsdljflsdjf sdlfjsdljflsdjfdjs fsdlfjlsdfjsdlf</li></ul>
                    <ul><li><span style="color:red">sdfsdfsdf - </span>asdfsfsdf sdfljsdlfsdfjs sdfljsdfljsdf sdflsdjfldsfjds sdfldjsfldsjfljdsf sdfldsjflsdjflsdf sdfljsdfljsdlfjsdlf sdlfjsdljflsdjf sdlfjsdljflsdjfdjs fsdlfjlsdfjsdlf</li></ul>
                    <ul><li><span style="color:red">sdfsdfsdf - </span>asdfsfsdf sdfljsdlfsdfjs sdfljsdfljsdf sdflsdjfldsfjds sdfldjsfldsjfljdsf sdfldsjflsdjflsdf sdfljsdfljsdlfjsdlf sdlfjsdljflsdjf sdlfjsdljflsdjfdjs fsdlfjlsdfjsdlf</li></ul>
                    <ul><li><span style="color:red">sdfsdfsdf - </span>asdfsfsdf sdfljsdlfsdfjs sdfljsdfljsdf sdflsdjfldsfjds sdfldjsfldsjfljdsf sdfldsjflsdjflsdf sdfljsdfljsdlfjsdlf sdlfjsdljflsdjf sdlfjsdljflsdjfdjs fsdlfjlsdfjsdlf</li></ul>
                    <ul><li><span style="color:red">sdfsdfsdf - </span>asdfsfsdf sdfljsdlfsdfjs sdfljsdfljsdf sdflsdjfldsfjds sdfldjsfldsjfljdsf sdfldsjflsdjflsdf sdfljsdfljsdlfjsdlf sdlfjsdljflsdjf sdlfjsdljflsdjfdjs fsdlfjlsdfjsdlf</li></ul>
                    <ul><li><span style="color:red">sdfsdfsdf - </span>asdfsfsdf sdfljsdlfsdfjs sdfljsdfljsdf sdflsdjfldsfjds sdfldjsfldsjfljdsf sdfldsjflsdjflsdf sdfljsdfljsdlfjsdlf sdlfjsdljflsdjf sdlfjsdljflsdjfdjs fsdlfjlsdfjsdlf</li></ul>
                    <ul><li><span style="color:red">sdfsdfsdf - </span>asdfsfsdf sdfljsdlfsdfjs sdfljsdfljsdf sdflsdjfldsfjds sdfldjsfldsjfljdsf sdfldsjflsdjflsdf sdfljsdfljsdlfjsdlf sdlfjsdljflsdjf sdlfjsdljflsdjfdjs fsdlfjlsdfjsdlf</li></ul>
                    <ul><li><span style="color:red">sdfsdfsdf - </span>asdfsfsdf sdfljsdlfsdfjs sdfljsdfljsdf sdflsdjfldsfjds sdfldjsfldsjfljdsf sdfldsjflsdjflsdf sdfljsdfljsdlfjsdlf sdlfjsdljflsdjf sdlfjsdljflsdjfdjs fsdlfjlsdfjsdlf</li></ul>
                </div>
                <textarea name="" id="" cols="30" rows="10"></textarea>
            </div>
            <img onclick="cancel(this)" id="cancel" src="./images/cancel.png" alt="">
        </div>
    </article>
     <script>
         window.addEventListener('load', function() {
            var images = document.getElementsByClassName('imge');
                preview = document.getElementById('preview');

            for (var i = 0; i < images.length; i++) {
                images[i].addEventListener('click', function(e){
                    preview.setAttribute('style', 'display:flex');
                    document.getElementById('preview_pic').setAttribute('src', this.firstChild.src);
                });
            }


         });
         function cancel(x) {
            var win = document.getElementById('preview');

            win.setAttribute('style', 'display:none');
         }
         function remove() {
             location.href = 'logout.php';
         }

        //  document.getElementById('butt').addEventListener('click', function() {
        //     //  window.alert('sdsdsd');
        //      document.getElementById('butt').classList.toggle("liked");
        //  });
        window.addEventListener('mousedown', function() {
            var bye = document.getElementById('bye');
            if(bye){
                bye.parentNode.removeChild(bye);
                var url = window.location.href.replace("?bye=good%20bye", "");
                window.history.pushState(null, null, url);
            }
        });
     </script>
</body>
</html>